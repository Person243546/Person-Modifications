<?xml version="1.0" encoding="utf-8" ?>
<Patch>
	
	<Operation Class="PatchOperationFindMod">
    <mods>
		<li>Ancient urban ruins old</li>
    </mods>
		<match Class="PatchOperationSequence">
		<operations>
		
	<li Class="PatchOperationAdd">
		<xpath>/Defs</xpath>
		<value>
		
		<ReplaceLib.ReplacerDef>
			<defName>MM Urban Ruins</defName>
			<replacers>
				<li>
					<replace>AM_Makarov</replace>
					<with>Gun_Autopistol</with>
				</li>
				<li>
					<replace>AM_APS</replace>
					<with>CE_Gun_ChargePistol</with>
				</li>
				<li>
					<replace>VWE_Gun_ChargeLMG</replace>
					<with>CE_Gun_ChargeLMG</with>
				</li>
				<li>
					<replace>VWE_Gun_ChargeSMG</replace>
					<with>CE_Gun_ChargeSMG</with>
				</li>
				<li>
					<replace>VWE_Gun_Flamethrower</replace>
					<with>CE_Gun_Flamethrower</with>
				</li>
				<li>
					<replace>VWE_Bow_Crossbow</replace>
					<with>CE_Gun_Crossbow</with>
				</li>
				<li>
					<replace>VWE_Gun_LeverActionRifle</replace>
					<with>CE_Gun_WinchesterNintyFour</with>
				</li>
				<li>
					<replace>VWE_Gun_HMG</replace>
					<with>CE_Gun_MSixty</with>
				</li>
				<li>
					<replace>VWE_Gun_ServiceRifle</replace>
					<with>CE_Gun_AKM</with>
				</li>
				<!--<li>
					<replace>VWE_Gun_MarksmanRifle</replace>
					<with>CE_Gun_SVD</with>
				</li>-->
				<li>
					<replace>VWE_Gun_Musket</replace>
					<with>CE_Gun_FlintlockMusket</with>
				</li>
				<li>
					<replace>VWE_Gun_Flintlock</replace>
					<with>CE_Gun_FlintlockPistol</with>
				</li>
				<li>
					<replace>VWE_Gun_BattleRifle</replace>
					<with>CE_Gun_FNFAL</with>
				</li>
				<li MayRequire="ceteam.combatextendedarmory">
					<replace>VWE_Gun_SemiAutomaticRifle</replace>
					<with>CE_Gun_SKS</with>
				</li>
				<li MayRequire="rimsenal.evp">
					<replace>VWE_Gun_Carbine</replace>
					<with>Gun_RSCarbine</with>
				</li>
				<li MayRequire="rimsenal.evp">
					<replace>CE_Gun_SigMCX</replace>
					<with>Gun_RSCarbine</with>
				</li>
				<li MayRequire="rimsenal.evp">
					<replace>CE_Gun_AKMSU</replace>
					<with>Gun_RSCarbine</with>
				</li>
				<li>
					<replace>Gun_ChargeSidearm</replace>
					<with>CE_Gun_ChargePistol</with>
				</li>
				<li>
					<replace>Gun_ScatterCharger</replace>
					<with>VWE_Gun_ChargeShotgun</with>
				</li><!--
				<li MayRequire="ceteam.combatextendedarmory">
					<replace>Gun_FR</replace>
					<with>CE_Gun_SKS</with>
				</li>
				<li>
					<replace>Gun_RSBattleRifle</replace>
					<with>CE_Gun_FNFAL</with>
				</li>-->
				<li>
					<replace>Gun_MilitiaRifle</replace>
					<with>CE_Gun_AKM</with>
				</li>
			</replacers>
		</ReplaceLib.ReplacerDef>
		
		</value>
	</li>
	
	<li Class="PatchOperationReplace">
		<xpath>/Defs/ThingDef[@Name="AMGun"]/weaponTags</xpath>
		<value>
			<weaponTags Inherit="False" />
		</value>
	</li>
	
	<li Class="PatchOperationRemove">
		<xpath>/Defs/ThingDef[
			defName="AM_Makarov" or
			defName="AM_APS" or
			defName="AM_FNHG" or
			defName="AM_CPHG" or
			defName="AM_Spear68C" or
			defName="AM_Spear68A" or
			defName="AM_M5A3LT" or
			defName="AM_TKB68A" or
			defName="AM_AK68A" or
			defName="AM_MK68A" or
			defName="AM_RM68A" or
			defName="AM_MCX" or
			defName="AM_MCXC" or
			defName="AM_ADAR" or
			defName="AM_M4A" or
			defName="AM_M4ASOP" or
			defName="AM_M4C" or
			defName="AM_M42U" or
			defName="AM_AK101A" or
			defName="AM_ASVAL" or
			defName="AM_VSS" or
			defName="AM_DTMDR" or
			defName="AM_MK17A" or
			defName="AM_R11A" or
			defName="AM_SR25A" or
			defName="AM_Hunter" or
			defName="AM_M700A" or
			defName="AM_MK18M" or
			defName="AM_PKM" or
			defName="AM_PKP" or
			defName="AM_AVT" or
			defName="AM_MPX" or
			defName="AM_MPXL" or
			defName="AM_STM" or
			defName="AM_STMC"]</xpath>
	</li>
	
	<li Class="PatchOperationReplace">
		<xpath>/Defs/ThingSetMakerDef[defName="AM_OrdinaryWeapons"]/root/options/li/thingSetMaker/fixedParams/filter/thingDefs</xpath>
		<value>
			<thingDefs>
				<li>Gun_Autopistol</li>
				<li>Gun_HeavySMG</li>
				<li>Gun_PumpShotgun</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_GlockSeventeen</li>
				<li MayRequire="ceteam.combatextendedguns">CE_Gun_SVD</li>
				<li MayRequire="rimsenal.evp">Gun_PistolHeavyRevolver</li>
				<li MayRequire="rimsenal.evp">Gun_AutomaticRifle</li>
				<li MayRequire="ceteam.combatextendedarmory">CE_Gun_M1903Springfield</li>
			</thingDefs>
		</value>
	</li>
	
	<li Class="PatchOperationReplace">
		<xpath>/Defs/ThingSetMakerDef[defName="AM_AdvancedWeapons"]/root/options/li[1]/thingSetMaker/fixedParams/filter/thingDefs</xpath>
		<value>
			<thingDefs>
				<li>Gun_AssaultRifle</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_MFourAOne</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_AKOneOFive</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_AKOneOThree</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_MOneA</li>
				<li MayRequire="harkon.gunnut.chapter2">HRK_AShTwelve</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_SAFiftyEight</li>
				<li MayRequire="harkon.gunnut.community">HRK_GalilACE</li>
				<li MayRequire="harkon.gunnut.community">HRK_M16AFour</li>
				<li MayRequire="harkon.gunnut.community">HRK_M4US</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_BullpupPKP</li>
				<li MayRequire="ceteam.combatextendedguns">CE_Gun_FNFAL</li>
				<li MayRequire="ceteam.combatextendedguns">CE_Gun_MSixty</li>
			</thingDefs>
		</value>
	</li>
	
	<li Class="PatchOperationReplace">
		<xpath>/Defs/ThingSetMakerDef[defName="AM_AdvancedWeapons"]/root/options/li[2]/thingSetMaker/fixedParams/filter/thingDefs</xpath>
		<value>
			<thingDefs>
				<li MayRequire="harkon.gunnut.chapter1">HRK_MFourAOne</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_MOneA</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_RSevenHundred</li>
				<li MayRequire="harkon.gunnut.chapter1">HRK_MPSevenAOne</li>
				<li MayRequire="harkon.gunnut.chapter2">HRK_ASVAL</li>
				<li MayRequire="harkon.gunnut.chapter2">HRK_SKS</li>
				<li MayRequire="harkon.gunnut.chapter2">HRK_PNinety</li>
				<li MayRequire="ceteam.combatextendedguns">CE_Gun_FNFAL</li>
				<li MayRequire="ceteam.combatextendedguns">CE_Gun_AKM</li>
				<li MayRequire="rimsenal.evp">Gun_RSCarbine</li>
			</thingDefs>
		</value>
	</li>
	
	<li Class="PatchOperationAdd">
		<xpath>/Defs/ThingSetMakerDef[defName="AM_VanillaWeapons"]/root/options/li[1]/thingSetMaker/fixedParams/filter/thingDefs</xpath>
		<value>
			<li MayRequire="rimsenal.evp">Gun_PistolHeavyRevolver</li>
			<li MayRequire="ceteam.combatextended">CE_FlareGun</li>
		</value>
	</li>
	
	<li Class="PatchOperationAdd">
		<xpath>/Defs/ThingSetMakerDef[defName="AM_VanillaWeapons"]/root/options/li[2]/thingSetMaker/fixedParams/filter/thingDefs</xpath>
		<value>
			<li MayRequire="vanillaexpanded.vwe">VWE_Gun_LightSMG</li>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_WinchesterNintyFour</li>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_MTwoFourNine</li>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_AKM</li>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_FNFAL</li>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_USASTwelve</li>
			<li MayRequire="harkon.gunnut.chapter1">HRK_SaigaTwelveK</li>
		</value>
	</li>
	
	<li Class="PatchOperationAdd">
		<xpath>/Defs/ThingSetMakerDef[defName="AM_VanillaWeapons"]/root/options/li[3]/thingSetMaker/fixedParams/filter/thingDefs</xpath>
		<value>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_SVD</li>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_HecateTwo</li>
			<li MayRequire="ceteam.combatextended">CE_DisposableRocketLauncher</li>
			<li MayRequire="ceteam.combatextended">CE_GrenadeLauncher</li>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_RPGSeven</li>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_MilkorMGL</li>
			<li MayRequire="ceteam.combatextendedguns">CE_Gun_Flamethrower</li>
		</value>
	</li>
	
	<li Class="PatchOperationAdd">
		<xpath>/Defs/ThingSetMakerDef[defName="AM_VanillaWeapons"]/root/options/li[4]/thingSetMaker/fixedParams/filter/thingDefs</xpath>
		<value>
			<li MayRequire="ceteam.combatextended">Weapon_GrenadeConcussion</li>
			<li MayRequire="ceteam.combatextended">Weapon_GrenadeFlashbang</li>
			<li MayRequire="ceteam.combatextended">Weapon_GrenadeSmoke</li>
			<li MayRequire="ceteam.combatextended">Weapon_GrenadeFirefoam</li>
			<li MayRequire="ludeon.rimworld.biotech">Weapon_GrenadeTox</li>
			<li MayRequire="keshash.grenadevariety">Weapon_GV_GrenadeStinger</li>
			<li MayRequire="keshash.grenadevariety">Weapon_GV_GrenadeThermobaric</li>
			<li MayRequire="keshash.grenadevariety">Weapon_GV_GrenadeIncendiary</li>
			<li MayRequire="keshash.grenadevariety">Weapon_GV_GrenadePipeBomb</li>
			<li MayRequire="keshash.grenadevariety">Weapon_GV_GrenadeAntiTank</li>
			<li MayRequire="keshash.grenadevariety">Weapon_GV_PrometheumBomb</li>
		</value>
	</li>
	
	<li Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="Gun_AssaultRifle"]/weaponTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="Gun_AssaultRifle"]</xpath>
			<value>
				<weaponTags/>
			</value>
		</nomatch>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="Gun_AssaultRifle"]/weaponTags</xpath>
			<value>
			</value>
		</match>
	</li>
	
	<li Class="PatchOperationAdd">
		<xpath>/Defs/ThingDef[
			defName="Gun_AssaultRifle"
			]/weaponTags</xpath>
		<value>
			<li>AMGuns</li>
			<li>AM</li>
		</value>
	</li>
	
	<li Class="PatchOperationAdd">
		<xpath>/Defs/ThingDef[
			defName="Gun_Autopistol"
			]/weaponTags</xpath>
		<value>
			<li>Autopistol</li>
		</value>
	</li>
	
	<li Class="PatchOperationFindMod">
    <mods>
		<li>Combat Extended Guns</li>
    </mods>
		<match Class="PatchOperationSequence">
		<operations>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
					defName="CE_Gun_PKM" or
					defName="CE_Gun_MSixty"
					]/weaponTags</xpath>
				<value>
					<li>PKM</li>
				</value>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
					defName="CE_Gun_AKM" or
					defName="CE_Gun_FNFAL" or
					defName="CE_Gun_SigMCX" or
					defName="CE_Gun_MSixty" or
					defName="CE_Gun_AKMSU"
					]/weaponTags</xpath>
				<value>
					<li>AMGuns</li>
					<li>AM</li>
				</value>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
					defName="CE_Gun_FNFAL"
					]/weaponTags</xpath>
				<value>
					<li>AMHP</li>
				</value>
			</li>
			
			<li Class="PatchOperationReplace">
				<xpath>/Defs/AncientMarket_Libraray.CustomMapDataDef[defName="AM_Supermarket_2L_S"]/thingDatas/li[def="AM_MK17A"]/def</xpath>
				<value>
					<def>CE_Gun_FNFAL</def>
				</value>
			</li>
			
		</operations>
		</match>
	</li>
	
	<li Class="PatchOperationFindMod">
    <mods>
		<li>Vanilla Weapons Expanded</li>
    </mods>
		<match Class="PatchOperationSequence">
		<operations>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
					defName="VWE_Gun_HMG"
					]/weaponTags</xpath>
				<value>
					<li>PKM</li>
				</value>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
					defName="VWE_Gun_Carbine" or
					defName="VWE_Gun_ServiceRifle"
					]/weaponTags</xpath>
				<value>
					<li>AMGuns</li>
					<li>AM</li>
				</value>
			</li>
			
		</operations>
		</match>
	</li>
	
	<li Class="PatchOperationFindMod">
    <mods>
		<li>Rimsenal - Augmented Vanilla Pack</li>
    </mods>
		<match Class="PatchOperationSequence">
		<operations>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
					defName="Gun_RSCarbine" or
					defName="Gun_MilitiaRifle" or
					defName="Gun_RSBattleRifle" or
					defName="Gun_AutomaticRifle"
					]/weaponTags</xpath>
				<value>
					<li>AMGuns</li>
					<li>AM</li>
				</value>
			</li>
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
					defName="Gun_RSBattleRifle"
					]/weaponTags</xpath>
				<value>
					<li>AMHP</li>
				</value>
			</li>
			
			<li Class="PatchOperationReplace">
				<xpath>/Defs/AncientMarket_Libraray.CustomMapDataDef[defName="AM_Supermarket_2L_S"]/thingDatas/li[def="AM_STM"]/def</xpath>
				<value>
					<def>Gun_RSCarbine</def>
				</value>
			</li>
			
		</operations>
		</match>
	</li>
	
	<li Class="PatchOperationFindMod">
    <mods>
		<li>[HRK] Gun Nut - Chapter #1</li>
    </mods>
		<match Class="PatchOperationSequence">
		<operations>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
					defName="HRK_BullpupPKP"
					]/weaponTags</xpath>
				<value>
					<li>PKM</li>
				</value>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
				defName = "HRK_AKOneOFive" or
				defName = "HRK_AKOneOThree" or
				defName = "HRK_MFourAOne" or
				defName = "HRK_RSevenHundred" or
				defName = "HRK_MOneA" or
				defName = "HRK_BullpupPKP" or
				defName = "HRK_SAFiftyEight" or
				defName = "HRK_MPSevenAOne"
					]/weaponTags</xpath>
				<value>
					<li>AMGuns</li>
					<li>AM</li>
				</value>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
				defName = "HRK_SAFiftyEight"
					]/weaponTags</xpath>
				<value>
					<li>AMHP</li>
				</value>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
				defName = "HRK_GlockSeventeen"
					]/weaponTags</xpath>
				<value>
					<li>Autopistol</li>
				</value>
			</li>
			
			<li Class="PatchOperationReplace">
				<xpath>/Defs/AncientMarket_Libraray.CustomMapDataDef[defName="AM_Supermarket_2L_S" or defName="AM_Supermarket_L"]/thingDatas/li[def="AM_M4A"]/def</xpath>
				<value>
					<def>HRK_MFourAOne</def>
				</value>
			</li>
			
			<li Class="PatchOperationReplace">
				<xpath>/Defs/AncientMarket_Libraray.CustomMapDataDef[defName="AM_Supermarket_2L_S"]/thingDatas/li[def="AM_FNHG"]/def</xpath>
				<value>
					<def>HRK_GlockSeventeen</def>
				</value>
			</li>
			
			<li Class="PatchOperationReplace">
				<xpath>/Defs/AncientMarket_Libraray.CustomMapDataDef[defName="AM_Reserve"]/thingDatas/li[def="AM_AK101A"]/def</xpath>
				<value>
					<def>HRK_AKOneOFive</def>
				</value>
			</li>
			
		</operations>
		</match>
	</li>
	
	<li Class="PatchOperationFindMod">
    <mods>
		<li>[HRK] Gun Nut - Chapter #2</li>
    </mods>
		<match Class="PatchOperationSequence">
		<operations>
		
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
				defName = "HRK_AShTwelve" or
				defName = "HRK_ASVAL" or
				defName = "HRK_GThirtySix" or
				defName = "HRK_SKS" or
				defName = "HRK_PNinety"
					]/weaponTags</xpath>
				<value>
					<li>AMGuns</li>
					<li>AM</li>
				</value>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
				defName = "HRK_AShTwelve"
					]/weaponTags</xpath>
				<value>
					<li>AMHP</li>
				</value>
			</li>
			
		</operations>
		</match>
	</li>
	
	<li Class="PatchOperationFindMod">
    <mods>
		<li>[HRK] Gun Nut - Community Pack</li>
    </mods>
		<match Class="PatchOperationSequence">
		<operations>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
					defName="HRK_M240B"
					]/weaponTags</xpath>
				<value>
					<li>PKM</li>
				</value>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
				defName = "HRK_SRTwentyFive" or
				defName = "HRK_M16AFour" or
				defName = "HRK_M4US" or
				defName = "HRK_GalilACE"
					]/weaponTags</xpath>
				<value>
					<li>AMGuns</li>
					<li>AM</li>
				</value>
			</li>
			
			<li Class="PatchOperationAdd">
				<xpath>/Defs/ThingDef[
				defName = "HRK_GalilACE"
					]/weaponTags</xpath>
				<value>
					<li>AMHP</li>
				</value>
			</li>
			
		</operations>
		</match>
	</li>
	
	<li Class="PatchOperationReplace">
		<xpath>/Defs/AncientMarket_Libraray.CustomMapDataDef[defName="AM_Supermarket_L"]/thingDatas/li[def="AM_MPX"]/def</xpath>
		<value>
			<def>Gun_HeavySMG</def>
		</value>
	</li>
	
	<li Class="PatchOperationFindMod">
    <mods>
		<li>Integrated Implants</li>
    </mods>
		<match Class="PatchOperationSequence">
		<operations>
	
	<li Class="PatchOperationConditional">
		<xpath>/Defs/ThingDef[defName="SkeletalBracing"]/techHediffsTags</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="SkeletalBracing"]</xpath>
			<value>
				<techHediffsTags>
					<li>SBracing</li>
				</techHediffsTags>
			</value>
		</nomatch>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/ThingDef[defName="SkeletalBracing"]/techHediffsTags</xpath>
			<value>
				<li>SBracing</li>
			</value>
		</match>
	</li>
	
	<li Class="PatchOperationAdd">
		<xpath>/Defs/PawnKindDef[defName="AncientSoldierBoss"]/techHediffsTags</xpath>
		<value>
			<li>SBracing</li>
		</value>
	</li>
	
	<li Class="PatchOperationReplace">
		<xpath>/Defs/PawnKindDef[defName="AncientSoldierBoss"]/techHediffsMoney</xpath>
		<value>
			<techHediffsMoney>3000~4000</techHediffsMoney>
		</value>
	</li>
	
	<li Class="PatchOperationAdd">
		<xpath>/Defs/PawnKindDef[defName="AncientMallGuards"]</xpath>
		<value>
			<techHediffsMoney>3000~4000</techHediffsMoney>
			<techHediffsChance>1</techHediffsChance>
			<techHediffsTags><li>SBracing</li></techHediffsTags>
		</value>
	</li>
	
		</operations>
		</match>
	</li>
	
		</operations>
		</match>
	</Operation>
	
</Patch>